<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The Cryptographer&#x27;s Codex</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="intro.html">Introduction</a></li><li class="chapter-item expanded affix "><a href="faq.html">FAQ</a></li><li class="chapter-item expanded "><a href="beginner/intro.html"><strong aria-hidden="true">1.</strong> Beginner series</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="beginner/copilot.html"><strong aria-hidden="true">1.1.</strong> Copilot my savior</a></li><li class="chapter-item expanded "><a href="beginner/cut_and_paste.html"><strong aria-hidden="true">1.2.</strong> Cut and paste</a></li><li class="chapter-item expanded "><a href="beginner/one_two_three.html"><strong aria-hidden="true">1.3.</strong> One two three</a></li><li class="chapter-item expanded "><a href="beginner/propagation.html"><strong aria-hidden="true">1.4.</strong> Propagation</a></li></ol></li><li class="chapter-item expanded "><a href="cryptopals/intro.html"><strong aria-hidden="true">2.</strong> Cryptopals</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="cryptopals/set_1.html"><strong aria-hidden="true">2.1.</strong> Set 1</a></li><li class="chapter-item expanded "><a href="cryptopals/set_2.html"><strong aria-hidden="true">2.2.</strong> Set 2</a></li><li class="chapter-item expanded "><a href="cryptopals/set_3.html"><strong aria-hidden="true">2.3.</strong> Set 3</a></li></ol></li><li class="chapter-item expanded "><a href="assorted/intro.html"><strong aria-hidden="true">3.</strong> Assorted guides</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="assorted/z3.html"><strong aria-hidden="true">3.1.</strong> Learning Z3</a></li><li class="chapter-item expanded "><a href="assorted/rust.html"><strong aria-hidden="true">3.2.</strong> Using Rust+Python for bruteforce</a></li></ol></li><li class="chapter-item expanded "><a href="resources/index.html"><strong aria-hidden="true">4.</strong> Resources</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="resources/python_tricks.html"><strong aria-hidden="true">4.1.</strong> Python tips and tricks</a></li><li class="chapter-item expanded "><a href="resources/env_setup.html"><strong aria-hidden="true">4.2.</strong> Setting up a Linux environment</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="resources/env/windows.html"><strong aria-hidden="true">4.2.1.</strong> Windows</a></li><li class="chapter-item expanded "><a href="resources/env/mac.html"><strong aria-hidden="true">4.2.2.</strong> Mac</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Cryptographer&#x27;s Codex</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="the-cryptographers-codex"><a class="header" href="#the-cryptographers-codex">The Cryptographer's Codex</a></h1>
<p>An opinonated introduction and general resource for those interested in cryptography</p>
<h2 id="contents"><a class="header" href="#contents">Contents</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Q</th><th>A</th></tr></thead><tbody>
<tr><td>Not sure if cryptography is your thing?</td><td>Start with the <a href="/beginner/intro.html">introductory beginner series</a> of challenges, they're a short series of 4 challenges that go from nothing to solving some real cryptography challenges</td></tr>
<tr><td>Wanting to learn more about cryptography?</td><td>Work on <a href="https://cryptopals.com/">cryptopals</a> and follow the <a href="/cryptopals/intro.html">companion guide</a>!</td></tr>
<tr><td>Done both and looking for more?</td><td>Take a look at <a href="https://cryptohack.org/">cryptohack</a> for more challenges that cover additional topics like elliptical curves</td></tr>
<tr><td>Want more low level systems-like cryptography?</td><td>Take a look at <a href="https://www.davidwong.fr/blockbreakers/index.html">Block Breakers</a> for a guided series on attacking block ciphers themselves</td></tr>
<tr><td>Prefer lecture style lessons instead of getting hands on with challenges?</td><td><a href="https://www.youtube.com/c/RPISEC_talks/videos">RPISEC</a> has a bunch of streamed lectures covering a number of cryptography concepts. (If anyone has any textbook recommendations feel free to open a PR on <a href="https://github.com/ubcctf/crypto-mdbook">the repo</a>)</td></tr>
<tr><td>Interested in building out your cryptography toolkit?</td><td>Check out some of the <a href="/assorted/intro.html">assorted guides</a></td></tr>
<tr><td>Want to test your skills against a set of beginner/intermediate challenges?</td><td>Try out <a href="https://picoctf.org/">picoCTF</a>, an excellent beginner CTF put on by CMU</td></tr>
<tr><td>Already built up a foundation with cryptohack/cryptopals?</td><td>Dive straight into CTFs! Check out <a href="https://ctftime.org/">ctftime</a> to get a list of upcoming events</td></tr>
</tbody></table>
</div>
<h2 id="tutorials"><a class="header" href="#tutorials">Tutorials</a></h2>
<ul>
<li><a href="/assorted/z3.html">Using z3 for cryptography</a></li>
<li><a href="/assorted/rust.html">Efficient bruteforcing with rust and python</a></li>
</ul>
<h2 id="resources"><a class="header" href="#resources">Resources</a></h2>
<ul>
<li><a href="/resources/env_setup.html">Setting up a programming environment for solving CTF challenges</a></li>
<li><a href="/resources/python_tricks.html">Python basics, tips, and tricks for the beginner cryptographer</a></li>
</ul>
<h2 id="about"><a class="header" href="#about">About</a></h2>
<p>The Cryptographer's Codex is primarily consisted of challenges and documents written up by <a href="https://github.com/rctcwyvrn">Arctic</a> of <a href="https://maplebacon.org/">Maple Bacon</a></p>
<p>The codex was an idea that I had when we (Maple Bacon) first hosted our beginner CTF for UBC students, SaplingCTF. The name was catchy so it stuck around and over time I built up more and more stuff that I had written up for various things so I thought I should just collect them together under site.</p>
<p>The end goal with the site is to have a place for us cryptographers to point interested CTF players towards, with a curated set of challenges, guides, and setup resources. </p>
<h2 id="contributing"><a class="header" href="#contributing">Contributing</a></h2>
<p>If you have a guide/resource that you would like to see added to the page, feel free to open a PR on <a href="https://github.com/ubcctf/crypto-mdbook">the github repo</a> and ping <code>@rctcwyvrn</code></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="frequently-asked-questions"><a class="header" href="#frequently-asked-questions">Frequently asked questions</a></h1>
<ul>
<li><a href="faq.html#why-cryptography">Why cryptography?</a></li>
<li><a href="faq.html#what-does-attacking-cryptography-teach-you">What does attacking cryptography teach you?</a></li>
<li><a href="faq.html#is-cryptography-just-math">Is cryptography just math?</a></li>
<li><a href="faq.html#what-skills-do-i-need-to-get-started">What skills do I need to get started?</a></li>
</ul>
<h2 id="why-cryptography"><a class="header" href="#why-cryptography">Why cryptography?</a></h2>
<p>It's a lot of fun! It feels great to think something is impossible to break, spend hours starting at it, and then eventually pry it apart and break it into pieces to make it decrypt out your flag.</p>
<p>The way I like to think about it is that solving CTF challenges usually involves trying to do something under a set of constraints. In binary exploitation the constraints are things like the state of the program, the stack, and the heap. In web the constraints are the various protections that websites implement.</p>
<p>In cryptography the constraints that we have to figure out how to weave our way through are the protocols themselves, the mathematics behind the operations and/or the implementation of them in the real world. I find crypto a lot of fun because these rules are arbitrary, they're just whatever the challenge author or protocol author thought of, leading to each challenge having it's own unique flavor rather than always having to deal with things like ASLR.</p>
<p>Cryptography is also uniquely vast in the kinds of ways that people try (and fail) to make connections secure, and the ways that we find to attack these protocols are also uniquely diverse. Having so many different ideas underpinning cryptography means there's a lot of things to learn and it's likely you'll find something that clicks for you and something you'll enjoy attacking, whether that's high level math-based attacks or low level cpu side-channel based attacks.</p>
<p>TLDR: Crypto challenges feel fresh and new because of the freedoms challenge authors have when writing their challenges. There's also an extremely wide range of cryptographic attacks and techniques so you can really look for what you find fun</p>
<h2 id="what-does-attacking-cryptography-teach-you"><a class="header" href="#what-does-attacking-cryptography-teach-you">What does attacking cryptography teach you?</a></h2>
<p>Unfortunately, since not many people will ever have to write their own crypto code, cryptography as a CTF category is less useful for a typical CS career than things like pwn or web which teach you directly applicable skills for memory and website security respectively.</p>
<p>However this doesn't mean that cryptography doesn't teach you anything! Crypto and other CTF categories teach you one extremely important thing, which is arguably the most important thing you can learn by doing CTFs, an attacker's mindset. </p>
<p>What is an &quot;attacker's mindset&quot;? It's a way of thinking where you pick and pry and try to break whatever bit of code you're looking at. It's a way of reading code where you carefully examine each part and consider what assumptions each function makes and how that might go wrong. It's understanding code not just for what it wants to do, but trying to prove in your head that it <em>only</em> does what it wants to do and can't be manipulated otherwise.</p>
<p>Experience doing this is highly useful in security obviously, but is also just useful for writing correct code in general. Most modern programming languages don't provide many guarantees (rip dependent types) on correctness or state and it often comes down to the programmer to be able to mentally check the preconditions and postconditions of your code. If you're highly used to doing this in an attacker's mindset then you end up being quicker at finding how things can go wrong, instead of being focused on the happy paths where everything goes right</p>
<p>Outside of practical skills, for me a big general lesson was that <em>shit can go wrong really fast</em>. Cryptography breaks with even the smallest of mistakes and learning some crytographic attacks is a good way of really hammering that lesson in. Cryptography is extremely important but there's a reason why there's a constant stream of new algorithms and papers attacking existing ones. There's a reason why the NIST standardization process takes years to go from new algorithm to established standard.</p>
<h2 id="is-cryptography-just-math"><a class="header" href="#is-cryptography-just-math">Is cryptography just math?</a></h2>
<p>No! There's plenty to do that won't touch <em>any</em> math at all!</p>
<p>Things with a lot of math:</p>
<ul>
<li>Most asymmetric cryptography (RSA, DH, ECC)
<ul>
<li>Key exchanges, signing, asymmetric encryption</li>
</ul>
</li>
<li>Random number generation (LCG, LFSR, MT)</li>
<li>Some post quantum cryptography (Lattices)</li>
<li>Quantum cryptography (Lots of physics)</li>
</ul>
<p>Things with <em>no</em> math:</p>
<ul>
<li>Most symmetric cryptography (AES)
<ul>
<li>Ciphers, block cipher modes</li>
<li>Some attacks on cipher construction start to involve some matricies (affine, linear attacks)</li>
</ul>
</li>
<li>Hashing (SHA)</li>
<li>Some post quantum cryptography (SPHINCS+)</li>
<li>Side channel attacks (Power, timing, cache)</li>
</ul>
<p>Disclaimer: You may find that a lot of CTFs have challenges skewed towards the math categories due to it being easier to write challenges for things like RSA and ECC. That doesn't mean that cryptography is all math, CTF stuff just tends to be skewed that way. </p>
<h2 id="what-skills-do-i-need-to-get-started"><a class="header" href="#what-skills-do-i-need-to-get-started">What skills do I need to get started?</a></h2>
<p>Generally across the board the requirements to do easy challenges in each category is the same</p>
<ul>
<li>A machine set up with your programming language of choice (typically <code>python</code>) 
<ul>
<li>Needs to be able to do basic operations and communicate with servers (<code>pwnlib</code> for python)</li>
</ul>
</li>
<li>A willingness to learn
<ul>
<li>This is extremely important! No matter how good you get at any CTF category, you'll always be banging your head feeling like a challenge is impossible and having no idea how to solve it. Being &quot;good&quot; at cryptography doesn't mean you instantly know how to solve something, it means you know how to learn how to figure out to attack something.</li>
</ul>
</li>
</ul>
<p>For the general &quot;types&quot; of challenges you find at CTFs, there are some requirements, but these really are quite minimal. I'm not trying to make these categories seem easier than they are, they really do just don't particularly require any other CS knowledge. You really can just sit down and learn how they work.</p>
<p>Attacking block ciphers (AES)</p>
<ul>
<li>The current standard block cipher, AES, is constructed with 4 steps. Substitution, XOR, shifting rows, and shifting columns</li>
<li>It turns out that some of these have mathematical representations, but at their core these operations are extremely simple. This is by design and is why AES is <em>so</em> fast</li>
</ul>
<p>Attacking block cipher modes (ECB, CBC, CTR, GCM)</p>
<ul>
<li>Block cipher modes usually involve simple operations like XORs</li>
<li>GCM mode is the main exception, since it creates an authentication code with a signature as part of it's encryption. This neccessitates it being more mathematical and complicated.</li>
</ul>
<p>Attacking hashing algorithms (SHA)</p>
<ul>
<li>Similarly to block ciphers, SHA2 is made up of a number of rounds that involve a number of simple steps (bit shifts and XORs only!)
<ul>
<li>All hashes that use the Merkle–Damgård construction are very similar (MD5)</li>
</ul>
</li>
<li>Common attacks usually involve a similar set of skills, lots of bit manipulations and XORS
<ul>
<li>Some statistical stuff maybe</li>
</ul>
</li>
</ul>
<p>Attacking RSA and Diffie Hellman</p>
<ul>
<li>RSA and DH rely on modular arithmetic. Understanding the basic algorithms is easy and just requires knowledge of how <code>mod</code> works</li>
<li>Understanding <em>why</em> RSA works is more involved and requires learning some number theory (Fermat's little theorem)</li>
<li>Basic attacks on RSA and DH involve basic math
<ul>
<li>For example, all the challenges in the <code>cryptopals</code> and <code>beginner asymmetric</code> sets of challenges don't require <em>any</em> of the more complicated math below</li>
</ul>
</li>
<li>More and more advanced attacks on RSA start to involve more and more complex mathematics 
<ul>
<li>RSA uses prime numbers and primes have a ton of unique mathematical properties that number theorists study. These sometimes become CTF challenges (eg: smooth primes)</li>
<li>Both algorithms use modular integers, or in math terms, finite Galois fields. Galois fields are extremely well studied and therefore have a lot of interesting properties that can lead to CTF challenges (eg: small subgroup confinement)</li>
<li>Neither of these are required at the start, but if you plan to really get into RSA and DH this is kinda where you're headed</li>
</ul>
</li>
</ul>
<p>Attacking ECC</p>
<ul>
<li>As the name implies (elliptical curve cryptography), you'll need to know about elliptical curves to learn about how ECC works
<ul>
<li>Elliptical curves are just a certain type of curve (like a weird sideways parabola)</li>
<li>The idea is to use points on this curve as a mathematical group because they have nice properties, so what ECC does is extend the algorithms for RSA and DH (which use Galois fields) to this new elliptical curve field. So similar algorithms, just points on a curve instead of numbers (which is weird if you haven't done this kinda math before)</li>
</ul>
</li>
</ul>
<div class="footnote-definition" id="1"><sup class="footnote-definition-label">1</sup>
<p>Knock on wood</p>
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="beginner-series"><a class="header" href="#beginner-series">Beginner series</a></h1>
<h3 id="basics"><a class="header" href="#basics">Basics</a></h3>
<p>Let's start with what you'll need to solve this set of challenges</p>
<ul>
<li>Basic programming ability</li>
<li>An environment with docker and python installed</li>
</ul>
<h3 id="what-exactly-will-you-be-doing-in-this-series-of-challenges"><a class="header" href="#what-exactly-will-you-be-doing-in-this-series-of-challenges">What exactly will you be doing in this series of challenges?</a></h3>
<p>Included are 4 beginner challenges attacking symmetric cryptography, ie cryptography where both you and your partner share a secret key. This type of encryption is what handles most secure connections between you and a server because it's fast and you only need to exchange a key to get started.</p>
<p>This series will attack a number of (relatively) modern symmetric encryption methods, showcasing how minor flaws or mistakes in implementations of these methods can result in a perfectly secure encryption becoming trivial to break!</p>
<p>These challenges were originally featured in a local CTF Maple Bacon put on for UBC students, if you want similar stuff for other categories, check out our challenge repo at <a href="https://github.com/ubcctf/sapling-ctf-2022">ubcctf/sapling-ctf-2022</a></p>
<p><strong>Note: The later challenges have spoilers for earlier challenges, so be careful! Don't skip ahead!!</strong></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="copilot-my-savior"><a class="header" href="#copilot-my-savior">Copilot my savior</a></h1>
<h2 id="challenge"><a class="header" href="#challenge">Challenge</a></h2>
<p>Copilot is great! Look at this great encryption function it wrote for me</p>
<p><img src="beginner//challenge-sources/copilot/thanks_copilot.png" alt="Copilot my savior" /></p>
<ul>
<li><a href="beginner//challenge-sources/copilot/encrypt.py">encrypt.py</a></li>
<li><a href="beginner//challenge-sources/copilot/flag.txt.enc">flag.txt.enc</a></li>
</ul>
<h2 id="getting-started"><a class="header" href="#getting-started">Getting started</a></h2>
<p>To solve this challenge you'll have to do some byte manipulations in python. If you haven't written python before, don't worry! Python is notoriously simple and easy to pick up, granted that you've written in an imperative language before.</p>
<ol>
<li>If you haven't set up a programming environment with python installed, start <a href="beginner//resources/env_setup.html">here</a></li>
<li>To get started with some byte manipulations in python, read <a href="beginner/resources/python_tricks.html">this</a></li>
</ol>
<p>All in all this challenge is really straightforward, the main goal is to get comfortable with python and doing byte manipulations</p>
<h2 id="ok-but-how-do-i-solve-this-thing"><a class="header" href="#ok-but-how-do-i-solve-this-thing">Ok but how do I solve this thing???</a></h2>
<p>You're given a program that takes a secret file (<code>flag.txt</code>) and &quot;encrypts&quot; it, changing it to something that is unreadable (<code>flag.txt.enc</code>). Your goal is to reverse this process </p>
<p>Some advice then:</p>
<ol>
<li>Look carefully at <code>encrypt.py</code>. What information do we not know? What does the <code>encrypt</code> function do? What could you do to undo it's effects if you knew the <code>???</code> value? </li>
<li>What happens if you XOR a byte by the same byte twice?</li>
<li>Think about the <code>???</code> value. What are the possible values that it could be? Could you try to guess it? How many guesses would you need to make? How would you know if your guess was correct?</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cut-and-paste"><a class="header" href="#cut-and-paste">Cut and paste</a></h1>
<h2 id="challenge-1"><a class="header" href="#challenge-1">Challenge</a></h2>
<p>Let's say you're making a video conferencing software and you need an encryption algorithm, but which one to pick?</p>
<p>There's so many options? Let's just choose the first one we see.</p>
<p>There's no way a real company would do something like that... right?</p>
<ul>
<li>https://securityboulevard.com/2020/04/simple-illustration-of-zoom-encryption-failure/</li>
<li>https://citizenlab.ca/2020/04/move-fast-roll-your-own-crypto-a-quick-look-at-the-confidentiality-of-zoom-meetings/</li>
</ul>
<p>Files:</p>
<ul>
<li><a href="beginner//challenge-sources/cut_and_paste/client.py">client.py</a></li>
<li><a href="beginner//challenge-sources/cut_and_paste/server.py">server.py</a>
<ul>
<li>Note: This file contains the flag hidden as base64, you could just decode it from there but that's no fun</li>
</ul>
</li>
<li><a href="beginner//challenge-sources/cut_and_paste/Dockerfile">Dockerfile</a></li>
<li><a href="beginner//challenge-sources/cut_and_paste/start.sh">start.sh</a></li>
</ul>
<h2 id="getting-set-up"><a class="header" href="#getting-set-up">Getting set up</a></h2>
<p>This is a hosted challenge, meaning you need to communicate with a server that's running <code>server.py</code>. How do you set this up?</p>
<p>You could</p>
<ul>
<li>A: (Recommended) Run the provided dockerfile by running the provided <code>./start.sh</code></li>
<li>B: Try to run the script directly, this only makes sense to do if you don't have <code>docker</code> installed and don't want to set it up for whatever reason</li>
</ul>
<h1 id="guide"><a class="header" href="#guide">Guide</a></h1>
<p>Welcome to challenge 2, where we'll be jumping straight into a modern encryption algorithm! Now you may think that just because this is a real encryption algorithm that Zoom really did use in their software that this challenge is going to be hard to solve.</p>
<p>But that isn't the case! Cryptography can often times be mathematically unbreakable, but present many flaws and pitfalls when brought to the real world.</p>
<p>So let's take a look at how that can happen</p>
<h2 id="how-does-modern-encryption-work"><a class="header" href="#how-does-modern-encryption-work">How does modern encryption work?</a></h2>
<p>What do you do when you want to make a message secret? The most common solutions use something that's called a <em>block cipher</em>.</p>
<p>What is a block cipher? It's a function that takes 16 bytes and a key, and encrypts it. The standard block cipher, AES, is extremely extremely good at doing this. It's been analyzed and tested to hell and back and no one has been able to break it. How it works is a bit complicated so you don't need to worry about it.</p>
<p>As a quick example. With the key &quot;catscatscatscats&quot;</p>
<ul>
<li>The encryption of &quot;mymessageiscool!&quot; is 7560e6979e56348cfe27616e0ca8567b</li>
<li>The encryption of &quot;mymessageiscool?&quot; is 59acdc0dbe8c2432c673bb05c2034c62</li>
<li>See how the results are completely different even though the inputs are very similar? That's a security feature of AES!</li>
<li>AES is secure in that if I gave you just &quot;7560e6979e56348cfe27616e0ca8567b&quot;, you would have no idea what my original message was without the key. But if you had the key, you can recover the original message just by running the decryption algorithm</li>
</ul>
<p>You might be wondering, if we have this perfect block encryption function, how could we possibly try to break any encryption? Didn't you say AES is unbreakable<sup class="footnote-reference"><a href="#1">1</a></sup>?</p>
<p>Well let me ask you, you have this function that encrypts 16 bytes exactly, how do you encrypt more? How do you, for example, encrypt 100 bytes?</p>
<h2 id="block-cipher-modes"><a class="header" href="#block-cipher-modes">Block cipher modes</a></h2>
<p>Block cipher modes are what allows you to do variable size encryption. Let's consider the most simple block cipher mode</p>
<p>Here's how you encrypt a variable number of bytes</p>
<ol>
<li>Add bytes to the end of the message in a special format so you know that you should remove it later</li>
<li>Keep adding bytes until the message is a multiple of 16, this is called &quot;padding&quot;</li>
<li>Split it into a bunch of 16 byte messages and encrypt them all</li>
<li>Append it all together, and send it off</li>
</ol>
<p>This is called Electronic Code Book, or ECB mode for short. It has a few glaring weaknesses, which you'll have to discover to solve the challenge!</p>
<h2 id="some-tips"><a class="header" href="#some-tips">Some tips</a></h2>
<ol>
<li>Take a look at <a href="beginner//challenge-sources/cut_and_paste/ecb_testing.html">this ECB mode visualizer</a> and play around with it, it gives a simple UI for visualizing blocks of a message and the resulting blocks of the plaintext
<ul>
<li>What happens when you edit half of a ciphertext? What does it decrypt to? What if you edit more/less of a block?</li>
<li>What happens if you change the order of blocks?</li>
</ul>
</li>
<li>What exactly do you have to do to get the flag? What do you need to trick the server into thinking?</li>
<li>Look at the challenge title! CTF challenges often hide little hints in the challenge titles</li>
<li>In CTF challenges you should be constantly thinking about what you have control over, and how you can abuse this control. In this setup you have three things you can control
<ul>
<li>The username and password you send when you register a user</li>
<li>The bytes you send to the server when it asks for a token</li>
</ul>
</li>
<li>What happens if your token is incomplete? Will the server accept it? How badly can you mangle your token and still have the server be ok with it?</li>
<li>The server uses <code>input()</code> to get your username and password, so you're limited to normal alphanumeric and punctuation characters, you can't input arbitrary bytes in there. How can you work around this?</li>
</ol>
<p>What can you do with this? How can you trick the server into encrypting something that you can use?</p>
<div class="footnote-definition" id="1"><sup class="footnote-definition-label">1</sup>
<p>At least we sure hope so</p>
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="one-two-three"><a class="header" href="#one-two-three">One two three</a></h1>
<h2 id="challenge-2"><a class="header" href="#challenge-2">Challenge</a></h2>
<p>Ok so ECB mode was a bust, what else can we try? What if don't use blocks at all?</p>
<ul>
<li><a href="beginner//challenge-sources/one_two_three/encryptor.py">encryptor.py</a></li>
<li><a href="beginner//challenge-sources/one_two_three/secret.enc">secret.enc</a></li>
</ul>
<h2 id="guide-1"><a class="header" href="#guide-1">Guide</a></h2>
<p>Good job figuring out the last challenge!</p>
<p>You saw that ECB mode has one crucial weakness, each block gets encrypted and decrypted exactly the same way, no matter where it's located in the ciphertext. This led you to be able to move blocks around to wherever you wanted and have the plaintext change in the same way.</p>
<p>So now that we know ECB is bad, how can we circumvent this problem? How can we make our cipher mode not have this problem?</p>
<h2 id="primer-the-one-time-pad"><a class="header" href="#primer-the-one-time-pad">Primer: The one time pad</a></h2>
<p>Let's say I want to encrypt a one byte message, and I decide to do so by XORing it with a random byte. I then happily send this off and you happen to be able to intercept it.</p>
<p>So you have this one byte encrypted message, which you know is something that I encrypted via XOR. Is it possible for you to figure out what the original message was?</p>
<p>It turns out that the answer is no! If the byte I used for the XOR was random, then the resulting encrypted byte is also completely random and unrelated in any way to my original message.</p>
<p>This is what is called &quot;information theoretically secure&quot;. Even if you had infinite time, you could never figure out which message my original byte was. This encryption scheme is called the <a href="https://en.wikipedia.org/wiki/One-time_pad">One-time pad</a></p>
<p>Now back to AES</p>
<h2 id="counter-mode"><a class="header" href="#counter-mode">Counter mode</a></h2>
<p>Let's say we want to bring that idea to reality, how can we generate a bunch of random bytes to xor our message against? </p>
<p>This stream of random bytes needs to be</p>
<ul>
<li>Able to be generated from the key, so we can regenerate it when we want to decrypt the message</li>
<li>But still random enough that it's secure</li>
</ul>
<p>Here's how Counter (CTR) mode achieves this</p>
<ol>
<li>Start a counter at c = 1</li>
<li>Pad c out to 16 bytes and encrypt it with your AES key</li>
<li>Then you have 16 random bytes, use that to XOR with your message</li>
<li>Then increment the counter and continue until you have enough random bytes to encrypt your entire message</li>
</ol>
<p>So the resulting ciphertext is like</p>
<ul>
<li>The first 16 bytes are the first 16 bytes of the plaintext XORd with the aes encryption E of the byte 1, E(pad(1))</li>
<li>The next 16 bytes are plaintext_2 XOR E(pad(2))</li>
<li>then plaintext_3 XOR E(pad(3)) and so on</li>
</ul>
<p>The stream of random bytes, ie E(pad(1)) | E(pad(2)) | E(pad(3)) ... is called the keystream</p>
<p>This evidently solves the issue with ECB we saw earlier, because if you move a block around then it'll be something completely different when you decrypt it, since it was encrypted with a different part of the keystream.</p>
<h2 id="the-twist"><a class="header" href="#the-twist">The twist</a></h2>
<p>Actually I lied, the description I gave is not the real CTR mode, because it has a crucial weakness!</p>
<p>Your job is to find this weakness and decrypt the messages found in <code>secret.enc</code></p>
<p>To solve this you'll need to figure out what this weakness is, use some googling to figure out why this weakness is so critical, and learn how you can exploit it.</p>
<p>Some tips:</p>
<ul>
<li><code>secret.txt</code> contains many lines of english text and, of course, the flag</li>
<li>You may find that your code from the first challenge, &quot;Copilot my savior&quot;, will come in handy</li>
<li>There's no shame in buying hints if you're stuck!</li>
</ul>
<h2 id="aside"><a class="header" href="#aside">Aside</a></h2>
<p>As is the pattern with the earlier challenges, this is actually a mistake that you can make when using CTR mode. Here's an excerpt from a paper about a very closely related cipher mode, GCM mode.</p>
<p>&quot;We investigate (redacted) issues with the GCM block cipher mode as used in TLS and focus in particular on AES-GCM, the most widely deployed variant. With an Internet-wide scan we identifed 184 HTTPS servers (redacted), which fully breaks the authenticity of the connections. Affected servers include large corporations, financial institutions, and a credit card company&quot;</p>
<h2 id="hints"><a class="header" href="#hints">Hints</a></h2>
<p>If you really need some hints, I've left some base64 encoded here</p>
<ol>
<li><code>TG9vayBjYXJlZnVsbHkgYXQgdGhlIGVuY3J5cHQgZnVuY3Rpb24uIEl0IGdlbmVyYXRlcyB0aGUga2V5c3RyZWFtIGZ1bGx5IGluZGVwZW5kZW50bHkgb2YgdGhlIHBsYWludGV4dCEgVGhpcyBtZWFucyB0aGF0IHRoZSBrZXlzdHJlYW0gaXMgaWRlbnRpY2FsIGZvciBlYWNoIHBsYWludGV4dC4gS25vd2luZyB0aGlzLCB3aGF0IGNhbiB5b3UgZG8/Cg==</code></li>
<li><code>V2Uga25vdyB0aGF0IHRoZSBrZXlzdHJlYW0gaXMgdGhlIHNhbWUgZm9yIGVhY2ggcGxhaW50ZXh0LCBidXQgd2hhdCBkb2VzIHRoaXMgbWVhbj8gVGhpcyBtZWFucyB0aGF0IHRoZSBmaXJzdCBieXRlIG9mIGVhY2ggbGluZSBpcyBYT1JkIGFnYWluc3QgdGhlIHNhbWUgYnl0ZSwgaWUgdGhlIGZpcnN0IGJ5dGUgb2YgdGhlIGtleXN0cmVhbS4gU2FtZSBmb3IgdGhlIHNlY29uZCBieXRlIG9mIGVhY2ggbGluZSBhbmQgc28gb24uIFRoaXMgaXMgcmVhbCBzaW1pbGFyIHRvIHRoZSBjb3BpbG90IGNoYWxsZW5nZSBpc24ndCBpdCEgWW91IGNhbiBndWVzcyBieXRlcyBpbiB0aGUgc2FtZSB3YXksIGJ1dCB5b3UgbmVlZCB0byBiZSBzbWFydGVyIGFib3V0IGZpZ3VyaW5nIG91dCB3aGVuIGEgZ3Vlc3MgaXMgJ2NvcnJlY3QnCg==</code></li>
<li><code>SG93IGNhbiB3ZSB0ZWxsIHdoZW4gYSBndWVzcyBpcyBjb3JyZWN0PyBXZWxsIHdlIGtub3cgdGhhdCB0aGUgdGV4dCBpcyBlbmdsaXNoLiBTbyBjYW4gYXNzaWduIGVhY2ggZ3Vlc3MgYSAnc2NvcmUnIGJhc2VkIG9uIGhvdyAnZW5nbGlzaCcgdGhlIHJlc3VsdCBpcy4gRm9yIGV4YW1wbGUsIGFkZGluZyBwb2ludHMgZm9yIGxldHRlcnMsIG51bWJlcnMsIHB1bmN0dWF0aW9uLCBhbmQgd2hpdGVzcGFjZSwgd2hpbGUgc3VidHJhY3RpbmcgcG9pbnRzIGZvciBlYWNoIGJ5dGUgdGhhdCBkb2Vzbid0IGZpdC4K</code></li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="propagation"><a class="header" href="#propagation">Propagation</a></h1>
<h2 id="challenge-3"><a class="header" href="#challenge-3">Challenge</a></h2>
<p>Ok so ECB mode was a bust, what else can we try? What about trying to chain blocks?</p>
<ul>
<li><a href="beginner//challenge-sources/propagation/server.py">server.py</a></li>
<li><a href="beginner//challenge-sources/propagation/client.py">client.py</a></li>
<li><a href="beginner//challenge-sources/propagation/Dockerfile">Dockerfile</a></li>
<li><a href="beginner//challenge-sources/propagation/start.sh">start.sh</a></li>
</ul>
<h2 id="guide-2"><a class="header" href="#guide-2">Guide</a></h2>
<p>Good job figuring out the last challenge!</p>
<p>You saw that ECB mode has one crucial weakness, each block gets encrypted and decrypted exactly the same way, no matter where it's located in the ciphertext. This led you to be able to move blocks around to wherever you wanted and have the plaintext change in the same way.</p>
<p>So now that we know ECB is bad, how can we circumvent this problem? How can we make our cipher mode not have this problem?</p>
<h2 id="block-chaining"><a class="header" href="#block-chaining">Block chaining</a></h2>
<p>Blocks should be encrypted differently based on where they are in the plaintext, so how about we encrypt a block differently based on the previous block?</p>
<p>If we try to move the block like we did with ECB, it'll fail because the previous block will be different, so this seems promising</p>
<p>Let's do it like this</p>
<ol>
<li>Assume we've encrypted the previous block to <code>C_0</code>, and now we want to encrypt plaintext block <code>P_1</code></li>
<li>Let the next ciphertext block be <code>AES(C_0 XOR P_1)</code>, basically xor the new plaintext block with the last <em>ciphertext</em> block before encrypting with AES</li>
</ol>
<p>But then what about the first block? It has no previous block to be XORd against. Well for that we introduce whats called an Initialization Vector, or IV for short. We basically just decide on some 16 bytes of random data, and this ensures each message is unique.</p>
<p>This cipher mode is called Cipher Block Chaining, or CBC for short. Wikipedia has an <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher_block_chaining_(CBC)">excellent diagram</a> showing how exactly the encryption and decryption for CBC work.</p>
<h2 id="the-challenge"><a class="header" href="#the-challenge">The challenge</a></h2>
<p>CBC mode was quite widespread for a long time and lacks any glaring weaknesses like ECB. However it's design leads it to have various pitfalls, one of which you'll need to exploit.</p>
<p>To find weaknesses in older cryptographic methods, it's often useful to look at their successors. For example CBC being ECB's successor makes it evident ECB's weakness in being too deterministic. One successor to CBC mode is Galois/Counter mode, or GCM mode for short.</p>
<p>One main feature that GCM provides is a built in message authentication code, which can basically be thought of as a tag that says &quot;yes this message is exactly what I sent, and has not been modified in any way&quot;. In essence it prevents attackers from being able to modify the ciphertext.</p>
<p>Knowing that this is something that CBC lacks, try to solve the challenge!</p>
<h2 id="tips"><a class="header" href="#tips">Tips</a></h2>
<ol>
<li>This challenge is structured extremely similarly to cut and paste, so take a look at some of the tips from that challenge. What still applies?</li>
<li>Remember the given <code>client.py</code> is just a starting point. It's possible you'll need to make modifications to it in order to return some information that it's just printing right now</li>
<li>Remember that the AES key will be different each time you connect to the server, you have to do everything in one connection</li>
<li>The code to solve this challenge is very short (you could probably golf it down to one or two lines), the difficulty lies in realizing what kind of manipulations you can make to the ciphertext. Once you realize the trick, you'll see that you have a lot of power over the resulting plaintext</li>
<li>Stare at the wikipedia diagram for CBC. Stare at it the entire time while writing your solution. Trust me, it'll help</li>
</ol>
<h2 id="hints-1"><a class="header" href="#hints-1">Hints</a></h2>
<p>If you really need some hints, I've left some base64 encoded here</p>
<ol>
<li><code>V2hhdCBoYXBwZW5zIGlmIHlvdSBtb2RpZnkgdGhlIGZpcnN0IGNpcGhlcnRleHQgYmxvY2sgc2xpZ2h0bHk/IFRoZSBBRVMgZGVjcnlwdGlvbiBvZiB0aGF0IGJsb2NrIHdpbGwgYmUgY29tcGxldGVseSBzY3JhbWJsZWQsIGJ1dCB3aGF0IGhhcHBlbnMgdG8gdGhlIGRlY3J5cHRpb24gb2YgdGhlIF9uZXh0XyBibG9jaz8gU2ltaWxhcmx5LCB3aGF0IGhhcHBlbnMgYWZ0ZXIgeW91IG1vZGlmeSB0aGUgSVY/Cg==</code></li>
<li><code>UmVtZW1iZXIgdGhlIFhPUiBvZiB0d28gaWRlbnRpY2FsIHZhbHVlcyBpcyB6ZXJvLiBJZiB5b3Uga25vdyB0aGF0IEEgWE9SIEIgPSBDIGFuZCB5b3Uga25vdyBDLCB5b3Uga25vdyB0aGF0IHRoaXMgKEEgWE9SIEMpIFhPUiBCIHdpbGwganVzdCBiZSBudWxsIGJ5dGVzLiBOb3cgd2hhdCBpZiB5b3Ugd2FudCBzb21ldGhpbmcgb3RoZXIgdGhhbiBudWxsIGJ5dGVzPyBXaGF0IGRvIHlvdSBuZWVkIHRvIGRvPwo</code></li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h2 id="cryptopals-companion"><a class="header" href="#cryptopals-companion">Cryptopals companion</a></h2>
<h1 id="this-is-a-work-in-progress-the-formatting-will-be-less-garbage-after-im-done-with-it"><a class="header" href="#this-is-a-work-in-progress-the-formatting-will-be-less-garbage-after-im-done-with-it">THIS IS A WORK IN PROGRESS! THE FORMATTING WILL BE LESS GARBAGE AFTER IM DONE WITH IT</a></h1>
<h2 id="preparations-before-we-start"><a class="header" href="#preparations-before-we-start">Preparations before we start</a></h2>
<ul>
<li>This companion in general will not provide any direct solutions, I instead mostly give leading questions. If you need solutions, plenty of solutions and writeups are just a google away, though remember that looking at the answers at the back of the book leads to understanding less.</li>
<li>Almost all ctfers use python for solving challenges across basically all categories, so that’s what I would recommend
<ul>
<li>For python, all you’ll need is
<ul>
<li>A working python installation</li>
<li><a href="https://pypi.org/project/pycryptodome/">pycryptodome</a></li>
<li>Something to write code with, <code>vscode</code> is nice</li>
</ul>
</li>
<li>I’ll be assuming you’ll be writing in python for this guide</li>
</ul>
</li>
<li>Make sure you read the homepage, everything it says is true
<ul>
<li>You don’t need (and aren’t expected to) know any cryptography beforehand
<ul>
<li>They do unfortunately skip out on defining some terms, but that’s what this companion is for</li>
</ul>
</li>
<li>You only need simple math 
<ul>
<li>The hard math is left to the professionals and we just copy their equations :)</li>
<li>No math shows up until set 5 anyway </li>
</ul>
</li>
<li>These challenges are attacks, not puzzles with tricks. The challenge authors make an effort to make the challenges clear and &quot;doable&quot;, instead of obfuscated like you'd see in competitions. This companion guide also helps clear up the occasional ambiguity and confusing wording</li>
<li>I like to put an extra little disclaimer whenever I recommend someone take a look at cryptopals, which is that after solving these challenges most people feel a strong feeling of dread. Dread when they realize how fragile cryptography can be and how most people writing code that uses cryptography are <strong>completely unaware</strong> that these fragile points exist</li>
</ul>
</li>
<li>The general structure of the sets is
<ul>
<li>Set 1 is preparation and “the qualifier set” </li>
<li>Sets 2-4 are various attacks on symmetric ciphers and a few hashes in set 4</li>
<li>Sets 5-6 are attacks on various asymmetric primitives, all using primes and numbers</li>
</ul>
</li>
<li>In case you’re wondering how well cryptopals will prepare you for CTFs, take a look at CSAW CTF 2020. Three challenges are basically directly taken from cryptopals and can be solved by copying over the code
<ul>
<li>Authy is a length extension sha attack, covered in challenge 29</li>
<li>modus operandi is a ciphertext detection challenge, covered in challenge 11</li>
<li>adversarial is a fixed nonce CTR, covered in challenges 6 and 20</li>
</ul>
</li>
</ul>
<h2 id="some-quick-definitions"><a class="header" href="#some-quick-definitions">Some quick definitions</a></h2>
<p><strong>Encryption</strong></p>
<ul>
<li>Encryption is turning a message (like “cryptography is cool”) and changing into a message that appears to be a garbled mess (like “falkjdior30vjs”) based on some “key”</li>
<li>The method of encrypting the message and what the key is vastly depends on the algorithm, for example in rsa the key is a number, in caesar ciphers the key is a table, and in aes the key is 16 bytes</li>
<li><strong>Plaintext</strong> is used to refer to the message before encryption and <strong>ciphertext</strong> is used for the garbled message after encryption</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cryptopals-set-1"><a class="header" href="#cryptopals-set-1">Cryptopals Set 1</a></h1>
<ul>
<li><a href="cryptopals/set_1.html#intro">Intro</a></li>
<li><a href="cryptopals/set_1.html#challenge-1-some-useful-functions-and-notes-about-python-bytes">Challenge 1: Some useful functions and notes about python bytes</a></li>
<li><a href="cryptopals/set_1.html#challenge-2-xor-in-python">Challenge 2: XOR in python</a></li>
<li><a href="cryptopals/set_1.html#challenge-3">Challenge 3</a></li>
<li><a href="cryptopals/set_1.html#challenge-4">Challenge 4</a></li>
<li><a href="cryptopals/set_1.html#challenge-5">Challenge 5</a></li>
<li><a href="cryptopals/set_1.html#challenge-6">Challenge 6</a></li>
<li><a href="cryptopals/set_1.html#challenge-7">Challenge 7</a></li>
<li><a href="cryptopals/set_1.html#challenge-8">Challenge 8</a></li>
</ul>
<h3 id="intro"><a class="header" href="#intro">Intro</a></h3>
<ul>
<li>A lot of this set comes down to how comfortable you are writing code in python</li>
<li>There is a little hitch in that byte representations in python changed a lot between python2 and python3, meaning stackoverflow answers and such will be outdated and might not work</li>
</ul>
<h3 id="challenge-1-some-useful-functions-and-notes-about-python-bytes"><a class="header" href="#challenge-1-some-useful-functions-and-notes-about-python-bytes">Challenge 1: Some useful functions and notes about python bytes</a></h3>
<ul>
<li><code>int(x, 16)</code> will parse the string x as a hex string, and return a number</li>
<li>The <code>Crypto.Util.number.long_to_bytes</code> and <code>Crypto.Util.number.bytes_to_long</code> functions from pycryptodome convert between numbers and bytes</li>
<li>Bytes in python are really just an array of ints between 0 and 255
<ul>
<li><code>b”hi”</code> is really just <code>[104, 105]</code></li>
<li>the <code>bytes()</code> constructor takes an int array and returns a bytes object</li>
<li>using a for loop or a list comprehension like <code>[x for x in my_bytes]</code> will return the int array</li>
<li>you can also index into bytes objects to get the integers, <code>b”hi”[0] == 104</code></li>
<li>Remember that bytes are just numbers with base 255</li>
</ul>
</li>
<li><code>ord()</code> takes a single character and returns its integer value</li>
<li><code>chr()</code> does the opposite, integer to char</li>
<li>the <code>base64</code> package has functions to go from bytes &lt;-&gt; base64 strings, namely <code>b64decode</code> and <code>b64encode</code></li>
</ul>
<h3 id="challenge-2-xor-in-python"><a class="header" href="#challenge-2-xor-in-python">Challenge 2: XOR in python</a></h3>
<ul>
<li>The xor operator in python is <code>^</code> and it takes two integers and returns the result of xor</li>
<li>A note about XOR in case you aren’t familiar: The operation cancels out with itself if you do it twice
<ul>
<li>Ie: <code>A xor B xor B == A</code></li>
<li>If you aren’t sure why this is the case, try writing out the table for XOR</li>
<li>This is why “encryption” and “decryption” are actually the same action when using XOR, you end up doing the exact same thing</li>
</ul>
</li>
<li>How do we use <code>^</code> with bytes objects? Remember that we can index into bytes objects to get the underlying integers, so try a for loop and then combining the results afterwards with <code>bytes()</code> back into a bytes object</li>
</ul>
<h3 id="challenge-3"><a class="header" href="#challenge-3">Challenge 3</a></h3>
<ul>
<li>This general idea comes up sometimes in cryptography attacks, but the idea is that we know the original must have been some english sentence, so we can bruteforce and see which one is most like an english sentence
<ul>
<li>This idea also can be generalized to cases where we know some &quot;structure&quot; that the original message must be in and use that information to inform our bruteforce</li>
</ul>
</li>
<li>Note: Do not be lazy and do it by eye, the “scoring” function will be needed in the next challenge</li>
<li>The <code>sorted()</code> function will probably come in handy</li>
<li><a href="https://en.wikipedia.org/wiki/Letter_frequency">https://en.wikipedia.org/wiki/Letter_frequency</a></li>
</ul>
<h3 id="challenge-4"><a class="header" href="#challenge-4">Challenge 4</a></h3>
<ul>
<li>Basically the same as challenge 3 but at a larger scale, same principle applies</li>
<li>We can assume that anything that isn’t encrypted with a single character XOR will result in a garbled mess when we perform an XOR on it</li>
</ul>
<h3 id="challenge-5"><a class="header" href="#challenge-5">Challenge 5</a></h3>
<ul>
<li>Just coding, good luck!</li>
<li>The modulo operator <code>%</code> will probably come in handy here</li>
</ul>
<h3 id="challenge-6"><a class="header" href="#challenge-6">Challenge 6</a></h3>
<ul>
<li>Hamming distance function tips
<ul>
<li>To format an integer as a binary string, use <code>“{0:b}”.format(x)</code></li>
<li>Use in combination with <code>bytes_to_long</code> to convert the bytes to the bit string</li>
<li>If the lengths differ, the difference in length should be added to the distance</li>
</ul>
</li>
<li>Solve tips
<ul>
<li>Try to reuse as much code from earlier challenges as possible</li>
<li>Transposing means taking <code>[[a,b,c], [1,2,3]]</code> and making it into <code>[[a,1], [b,2], [c,3]]</code></li>
</ul>
</li>
<li>An aside
<ul>
<li>I’ve actually used my code for this challenge quite a few times. You might be wondering what real world algorithm uses a repeating key xor and the answer is none, but many ciphers do actually use XORs. This challenge may seem like a toy challenge, but when we get to challenge 20 in set 3, you’ll see how this attack actually works <strong>very well</strong> on a popular block cipher mode.</li>
</ul>
</li>
</ul>
<p>Some definitions</p>
<ul>
<li><strong>AES</strong> (Advanced Encryption Standard) is a <strong>block cipher</strong>, it takes a block of 16 bytes and garbles it based on a 16 byte key
<ul>
<li>However this presents a problem, what do you do if your message is longer than 16 bytes, for example a 32 byte message?</li>
<li>If you’re curious about what AES does under the hood (not needed for these challenges, but fun to learn about) https://www.youtube.com/watch?v=O4xNJsjtN6E</li>
</ul>
</li>
<li><strong>ECB</strong> stands for Electronic Code Book, and is a <strong>block cipher mode of operation</strong>. Block cipher modes are ways of making block ciphers (which can only encrypt a single block) usable for larger messages
<ul>
<li>ECB is the most straightforward, cut the message into blocks and encrypt each of them separately.</li>
<li>This turns out to be a terrible way of doing things, and you’ll see why in the next few challenges</li>
<li>https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Electronic_codebook_(ECB)</li>
</ul>
</li>
</ul>
<h3 id="challenge-7"><a class="header" href="#challenge-7">Challenge 7</a></h3>
<ul>
<li>pycryptodome provides an AES implementation in Crypto.Cipher.AES
<ul>
<li>https://pycryptodome.readthedocs.io/en/latest/src/cipher/aes.html</li>
</ul>
</li>
<li>You should make both encryption and decryption functions, you’ll need it in a bit</li>
</ul>
<h3 id="challenge-8"><a class="header" href="#challenge-8">Challenge 8</a></h3>
<ul>
<li>There is a hidden assumption in this challenge that I think really should have been mentioned. <strong>The challenge assumes that the plaintext must have a repeated block</strong>. </li>
<li>The important point here is that ECB is the only cipher mode that has this property, that the same plaintext blocks will result in the same ciphertext blocks
<ul>
<li>This weakness of ECB turns out to cause many many problems, which you’ll see in set 2</li>
<li>The worst part is ECB is seen as the “default” setting for block ciphers, despite it being almost always a terrible idea</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cryptopals-set-2"><a class="header" href="#cryptopals-set-2">Cryptopals Set 2</a></h1>
<ul>
<li><a href="cryptopals/set_2.html#challenge-9">Challenge 9</a></li>
<li><a href="cryptopals/set_2.html#challenge-10-a-new-block-cipher-mode-cbc">Challenge 10: A new block cipher mode, CBC</a></li>
<li><a href="cryptopals/set_2.html#challenge-11">Challenge 11</a></li>
<li><a href="cryptopals/set_2.html#challenge-12">Challenge 12</a></li>
<li><a href="cryptopals/set_2.html#challenge-13-cut-and-paste">Challenge 13: Cut and paste</a></li>
<li><a href="cryptopals/set_2.html#challenge-14">Challenge 14</a></li>
<li><a href="cryptopals/set_2.html#challenge-15">Challenge 15</a></li>
<li><a href="cryptopals/set_2.html#challenge-16">Challenge 16</a></li>
</ul>
<h3 id="challenge-9"><a class="header" href="#challenge-9">Challenge 9</a></h3>
<ul>
<li>Fairly straightforward, just some more programming</li>
</ul>
<h3 id="challenge-10-a-new-block-cipher-mode-cbc"><a class="header" href="#challenge-10-a-new-block-cipher-mode-cbc">Challenge 10: A new block cipher mode, CBC</a></h3>
<ul>
<li><strong>CBC</strong> or Cipher block chaining is another block cipher mode
<ul>
<li>The goal of CBC is to not be deterministic like ECB, ie two identical plaintext blocks should encrypt to <em>different</em> ciphertext blocks</li>
<li>How does it accomplish this?
<ul>
<li>CBC requires an extra <strong>initialization vector</strong> or IV for short, which is just random bytes the size of a block</li>
<li>For each plaintext block we want to xor our plaintext with something first, and then encrypt it with our cipher
<ul>
<li>For the first block we xor it with the IV before encrypting</li>
<li>For every other block we xor it with the <em>last ciphertext block</em></li>
</ul>
</li>
<li>Essentially “chaining” the different blocks together, so the resulting ciphertext of a block depends on the “sum” of all the previous blocks and the IV</li>
</ul>
</li>
<li>https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher_block_chaining_(CBC) has some very useful diagrams</li>
</ul>
</li>
<li>Implementing it is fairly straightforward once you understand whats going on</li>
<li>Decryption is just running this in reverse, block cipher decryption first and then xor</li>
<li>Note: ECB mode with one block is the same as just running the cipher, so you can reuse that as long as you’re encrypting/decrypting only one block</li>
</ul>
<p><img src="cryptopals//assets/images/cbc_encryption.png" alt="CBCEncryption" /></p>
<h3 id="challenge-11"><a class="header" href="#challenge-11">Challenge 11</a></h3>
<ul>
<li>This is a bit of a weird challenge, I’m not really sure what it’s accomplishing?</li>
<li>I don’t think there’s a good way to detect CBC mode, so I just detected ECB mode and then guessed CBC otherwise</li>
<li>Again, it only works if you send a plaintext with repeated blocks</li>
<li>Idk, maybe skip this one, it kinda comes back in challenge 12 but as an “optional” thing</li>
</ul>
<h3 id="challenge-12"><a class="header" href="#challenge-12">Challenge 12</a></h3>
<ul>
<li>Now don’t skip this one though, because it’s really cool (and also shows up in real CTFs!)</li>
<li>The explanation is pretty good for how to get the first byte of the unknown-string, but the next step and automating it can be a bit tricky
<ul>
<li>For the next byte you would first send 14 A’s + the first byte of the unknown string
<ul>
<li>The first block would then be aes(“A”s + first byte + second byte)</li>
</ul>
</li>
<li>Then you want to start sending 13 A’s + first byte + guesses for the second byte</li>
<li>And then like last time stop when you find a match</li>
</ul>
</li>
<li>The congratulations at the bottom is pretty accurate for CTFs too, every once in awhile I see another one of these pop up
<ul>
<li><a href="https://ctftime.org/writeup/18675">Here’s the last one I remember</a></li>
</ul>
</li>
</ul>
<h3 id="challenge-13-cut-and-paste"><a class="header" href="#challenge-13-cut-and-paste">Challenge 13: Cut and paste</a></h3>
<ul>
<li>This one is fun to figure out, it’s the first time the authors really let you out and try to figure out how to do what it wants</li>
<li>The title is a big hint, if we could copy paste things, what <em>would</em> we want to cut and replace?</li>
<li>Given that this is ECB mode, what exactly can we cut and replace? (bits? bytes? characters? blocks? messages?)</li>
</ul>
<h3 id="challenge-14"><a class="header" href="#challenge-14">Challenge 14</a></h3>
<ul>
<li>Some clarification on this challenge, I originally thought the random prefix would be generated each time, a new random prefix of random length each time you touch the oracle</li>
<li>I honestly don’t really know how one would go about solving that, so I and everyone else who has write ups for cryptopals instead assumed that the random prefix would be generated once and be reused for all later oracle calls</li>
<li>So now the trouble is really just one thing, how long is that random prefix? How can you figure that out?</li>
</ul>
<h3 id="challenge-15"><a class="header" href="#challenge-15">Challenge 15</a></h3>
<ul>
<li>More programming stuff, this is just setup for challenge 17, which is gonna be a big one</li>
</ul>
<h3 id="challenge-16"><a class="header" href="#challenge-16">Challenge 16</a></h3>
<ul>
<li>Another fun one to figure out</li>
<li>Try to think about what happens in CBC decryption with the user data block and the block after it</li>
<li>How can we completely replace the second ciphertext block in a way to make the third block decrypt to what we want, namely “;admin=true;”? What happens to the second plaintext block in that case?</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cryptopals-set-3"><a class="header" href="#cryptopals-set-3">Cryptopals Set 3</a></h1>
<ul>
<li><a href="cryptopals/set_3.html#intro">Intro</a></li>
<li><a href="cryptopals/set_3.html#challenge-17">Challenge 17</a></li>
</ul>
<h2 id="intro-1"><a class="header" href="#intro-1">Intro</a></h2>
<ul>
<li>For me, this is the set where things really started to get fun</li>
<li>This note at the start made me really hyped and I hope it makes you excited too
<ul>
<li>“We've also reached a point in the crypto challenges where all the challenges, with one possible exception, are valuable in breaking real-world crypto.”</li>
</ul>
</li>
</ul>
<h2 id="challenge-17"><a class="header" href="#challenge-17">Challenge 17</a></h2>
<ul>
<li>This is a great challenge
<ul>
<li>CBC is (unfortunately) still a relatively popular block cipher mode, and is seen as &quot;the good alternative&quot; to ECB</li>
<li>This directly builds off of what you learned about CBC decryption in challenge 16, how bit flips in one ciphertext block affect the resulting decryption in the next block</li>
<li>This shows off how useful these side channel leaks are. A <strong>side channel leak</strong> is when a system unintentionally reveals information about it's inner workings
<ul>
<li>For this challenge, the &quot;decryption server&quot; is leaking the fact that the padding is invalid</li>
<li>For later challenges you'll see that even leaking how long the code takes to run can be enough to cryptography</li>
<li>Some other side channels you won't see in cryptopals: 
<ul>
<li>The amount of power the CPU is using can be used to retrieve AES keys from smart cards</li>
<li>Using information about the CPU cache to break OpenSSL's carefully implemented RSA algorithm https://web.eecs.umich.edu/~genkin/cachebleed/index.html</li>
</ul>
</li>
</ul>
</li>
<li>CBC padding oracles also show up from time to time in CTFs, though more rarely due to how famous this attack is</li>
</ul>
</li>
<li>Here is a good explanation of the attack: https://robertheaton.com/2013/07/29/padding-oracle-attack/ </li>
<li>From my experience this challenge is not necessarily conceptually difficult, but can be a bit tricky to get right
<ul>
<li>Start with just finding one byte, then work towards automating it for the rest of the bytes in the block, and then finally for multiple blocks</li>
<li>Made sure the padding functions from set 2 are fully correct
<ul>
<li>A plaintext that is all padding should be accepted</li>
<li>A plaintext with no padding should be rejected</li>
</ul>
</li>
</ul>
</li>
<li>Aside: Anyone else feeling that dread after realizing that all it takes to break a perfectly secure algorithm like AES and a reasonably sensible mode like CBC is something as small as having two different error messages for wrong password vs bad padding? Because I definitely was</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="assorted-guides"><a class="header" href="#assorted-guides">Assorted guides</a></h1>
<p>Various guides for useful techniques when solving cryptography challenges</p>
<h2 id="z3"><a class="header" href="#z3">z3</a></h2>
<p><a href="assorted//assorted/z3.html">Full guide</a></p>
<p><code>z3</code> is a useful tool for solving sets of constraints, for example when you know the state of the random number generator after n steps and want to easily recover the state from the start</p>
<h2 id="rust"><a class="header" href="#rust">Rust</a></h2>
<p><a href="assorted//assorted/rust.html">Full guide</a></p>
<p><code>python</code> is very convinient for communicating with services and rapidly prototyping but is often too slow for anything beyond a quick bruteforce. <code>rust</code> is very very fast, supports very easy python interop using <code>pyo3</code>, and has easy multithreaded iteration using <code>rayon</code>. </p>
<div style="break-before: page; page-break-before: always;"></div><p>Coming soon</p>
<div style="break-before: page; page-break-before: always;"></div><p>Coming soon</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="resources-1"><a class="header" href="#resources-1">Resources</a></h1>
<ul>
<li><a href="resources/./env_setup.html">Environment setup guides</a></li>
<li><a href="resources/./python_tricks.html">Python tips and tricks</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="basic-python-tips-and-tricks"><a class="header" href="#basic-python-tips-and-tricks">Basic python tips and tricks</a></h2>
<p>This should cover most of the python api you'll commonly use when solving cryptography problems (except <code>pycryptodome</code> but we don't need to worry about that for now)</p>
<p>I would recommend having the python REPL open (type <code>python</code> in the command line) and following along with the code examples</p>
<h2 id="the-basics"><a class="header" href="#the-basics">The basics</a></h2>
<pre><code class="language-python"># The bytes type is usually defined like this 

my_bytes = b&quot;this is not a string, but a bytes object!&quot;

list(my_bytes) # converts my_bytes to a list of numbers
bytes(my_list) # converts a list of numbers to a bytes object
</code></pre>
<p>A Bytes object is really just a list of numbers, and you can see that by running <code>list(b&quot;my bytes&quot;)</code> or <code>b&quot;my bytes&quot;[0]</code>. There is one important detail, which is that a number in a byte array is always between 0 and 255, which is 2**8-1. For details, wait til cpsc 121!</p>
<p>In general</p>
<ul>
<li>You get bytes objects from reading stuff (ie <code>open(&quot;data&quot;,&quot;rb&quot;).read()</code>) or converting from other data formats (hex, base64)</li>
<li>You usually want to work with the list of numbers (because you can then map and iterate over it easily)</li>
<li>You want to convert your final result to a bytes object to print it (because python will then format it nicely for you)</li>
</ul>
<h2 id="two-more-important-functions"><a class="header" href="#two-more-important-functions">Two more important functions</a></h2>
<pre><code class="language-python">chr(x) # converts a decimal number x between 0 and 255 to it's character
ord(c) # converts a character c to it's corresponding byte number

ord(&quot;a&quot;) == 97
chr(97) == &quot;a&quot;
</code></pre>
<p>Since all bytes are numbers and we sometimes want bytes to represent characters instead of random numbers, some smart people figured out the <a href="https://www.asciitable.com/">ascii table</a> and that's what <code>ord</code> and <code>chr</code> use.</p>
<h2 id="decode-and-encode"><a class="header" href="#decode-and-encode">Decode and encode</a></h2>
<p>Very similar to <code>chr</code> and <code>ord</code></p>
<pre><code class="language-python">&quot;my string&quot;.encode() # converts from a string to bytes
b&quot;my bytes&quot;.decode() # converts from bytes to a string
</code></pre>
<p>These can be thought of as shorthand for calling <code>ord</code>/<code>chr</code> on each character/number in a string/bytes.</p>
<h2 id="how-to-work-with-bytes"><a class="header" href="#how-to-work-with-bytes">How to work with bytes</a></h2>
<p>Your best friends will probably be good ol' for loops</p>
<p>For the imperatively minded, this will print the numbers in the array, so <code>101</code>, <code>121</code>, <code>32</code> ...</p>
<pre><code class="language-python">for b in b&quot;my bytes&quot;:
    print(b)
</code></pre>
<p>For the functionally minded (and those who took 110), python does have maps and filters and such</p>
<pre><code class="language-python">list(map(lambda x: x+1, b&quot;my bytes&quot;))
</code></pre>
<p>My preferred method is using python <a href="https://www.w3schools.com/python/python_lists_comprehension.asp">list comprehensions</a> since they're basically less clunky maps</p>
<pre><code class="language-python">[x+1 for x in b&quot;my bytes&quot;]
</code></pre>
<h2 id="xor"><a class="header" href="#xor">XOR</a></h2>
<p>If you've taken 121 you've seen it before, but it turns out that xor is actually quite important for various parts of cryptography. If you haven't taken 121, you'll want to understand how xor works so google &quot;bitwise XOR&quot;. Good googling skills are important!</p>
<h2 id="xor-in-python"><a class="header" href="#xor-in-python">XOR in python</a></h2>
<p>python has a xor operator, <code>^</code></p>
<pre><code class="language-python">x ^ y # this is x xor y
      # x and y have to be numbers
</code></pre>
<p>Since <code>^</code> only operates on numbers, you have to use one of the above strategies for actually xoring your entire bytes object.</p>
<h2 id="files-in-python"><a class="header" href="#files-in-python">Files in python</a></h2>
<p>This might be a bit tricky if you haven't seen this type of interface before, but here's how you work with files in python</p>
<pre><code class="language-python">mode = &quot;r&quot; # Read my file as a big string
mode = &quot;rb&quot; # Read my file as a big bytes object 
mode = &quot;w&quot; # Write strings to my file
mode = &quot;wb&quot; # Write bytes to my file

f = open(&quot;my_filename&quot;, mode) # Open &quot;./my_filename&quot; with the given mode

# if you don't input a mode, the mode is assumed to be &quot;r&quot;

# You have to give a filename that already exists to use either r or rb
# But you can use w or wb with a file that doesnt exist, python will create the file for you

# f is a file object, the functions you can call on it are:
f.close() # Closes the file, must always be called or else bad things happen

# =============================================
# if you opened as mode = &quot;r&quot;
f.read()      # Returns the entire contents of the file as a big string
f.readlines() # Returns an array of strings where each string is a line from the file

# =============================================
# if you opened as mode &quot;rb&quot;
f.read()      # Returns the entire contents of the file as a big bytes object

# =============================================
# if you opened as mode &quot;w&quot;
f.write(my_string) # Writes the string into the file

# =============================================
# if you opened as mode &quot;wb&quot;
f.write(my_bytes)  # Writes the bytes into the file
</code></pre>
<p>This is only a basic summary, but hopefully it gives you the basic gist for how files work in python. You can read more about them <a href="https://www.programiz.com/python-programming/file-operation">here</a>. If you're curious about why files work like this and why you need to seek around a file then wait til 313! You'll learn all about them there.</p>
<h2 id="bash-tricks"><a class="header" href="#bash-tricks">Bash tricks</a></h2>
<p>Did you know that you can automatically make any program write to a file instead of printing out it's results?</p>
<pre><code class="language-bash">$ python my_script.py &gt; result.txt
</code></pre>
<p>Anything that <code>my_script.py</code> prints out will be put into <code>result.txt</code> instead of being shown on the terminal.</p>
<h2 id="for-those-who-really-want-to-write-racket-in-python"><a class="header" href="#for-those-who-really-want-to-write-racket-in-python">For those who really want to write racket in python</a></h2>
<p>Here's some functions to get you started</p>
<pre><code class="language-python">def cons(x, xs):
    return [x] + xs

def first(b):
    return b[0]

def rest(b):
    return b[1:] # &lt;-- python slice notation

def fn_for_bytes(b):
    if len(b) == 0:
        return # ...
    else:
        first_res = # ... fn_for_byte(first(b)) 
        rest_res =  # ... fn_for_bytes(rest(b))
        result =    # ... first_res, rest_res
        return result
</code></pre>
<p>(PS: Though all the code you'll be presented with will be in an imperative style, so you should get used to the whole imperative thing)</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="environment-setup"><a class="header" href="#environment-setup">Environment setup</a></h2>
<p>For solving CTF challenges in general, there's a few things that you'll need. Specific instructions for how to install these tools are in their respective OS pages</p>
<ul>
<li><a href="resources/./env/windows.html">Windows</a></li>
<li><a href="resources/./env/mac.html">Mac</a></li>
</ul>
<h3 id="a-linux-shell"><a class="header" href="#a-linux-shell">A Linux shell</a></h3>
<p>While not a strict requirement technically, a linux shell will almost inevetiably become a requirement as you do more CTF challenges. Installing tools, running binaries, debugging, these are all much easier to do with a fully fledged linux shell vs using a shell emulator or something like powershell</p>
<p>The good part is that installing a proper linux environment is now quite easy</p>
<ul>
<li>MacOS comes with one pre-installed</li>
<li>Windows now supports Windows Subsystem for Linux (WSL) v2, which is easy to install and gives you everything you need</li>
</ul>
<h3 id="basic-tools"><a class="header" href="#basic-tools">Basic tools</a></h3>
<p>A basic suite of tools you'll want are</p>
<ul>
<li><code>python</code>, the programming language of choice for most CTFers. Comes preinstalled on all linux shells
<ul>
<li>You'll want some additional libraries though, namely <code>pycryptodome</code> which implements all the cryptographic algorithms you'll need, and <code>pwntools</code> which makes connecting to servers programatically easy</li>
</ul>
</li>
<li><code>netcat</code>, a tool for connecting to ports on servers, which is what you'll need to do to connect to challenge instances</li>
<li><code>curl</code>, a tool for making http/https requests, useful for challenges that are on websites</li>
</ul>
<h3 id="docker"><a class="header" href="#docker">Docker</a></h3>
<p>Docker is a tool that lets you package up a &quot;mini vm&quot; of sorts as a list of instructions. This lets challenge authors give you a <code>Dockerfile</code> and let you rebuild the challenge server for your own local testing, which you'll definitely want to be able to do</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="environment-setup-windows"><a class="header" href="#environment-setup-windows">Environment setup: Windows</a></h2>
<h3 id="tldr"><a class="header" href="#tldr">TLDR</a></h3>
<ol>
<li>Install Ubuntu WSL2</li>
<li><code>sudo apt install netcat curl python3</code></li>
<li><code>python -m ensurepip --upgrade</code></li>
<li><code>python -m pip install pycryptodome pwntools</code></li>
<li>Install Docker for windows and enable the wsl2 backend</li>
<li>Install vscode and enable the <code>Remote: WSL</code> extension</li>
</ol>
<h3 id="step-1-install-wsl"><a class="header" href="#step-1-install-wsl">Step 1: Install WSL</a></h3>
<p>Microsoft provides very in depth installation instructions on <a href="https://docs.microsoft.com/en-us/windows/wsl/install">https://docs.microsoft.com/en-us/windows/wsl/install</a>. <code>Ubuntu</code> is the OS you want if you have no prior experience with Linux</p>
<p>There's additional steps for setting up your installation at <a href="https://docs.microsoft.com/en-us/windows/wsl/setup/environment">https://docs.microsoft.com/en-us/windows/wsl/setup/environment</a></p>
<ul>
<li>This includes information on setting up <code>docker</code> and <code>vscode</code>, both of which you should install in a bit</li>
<li>Optional: WSL can be a bit sluggish with it's default settings, check out <a href="https://jade.fyi/blog/development-in-wsl/">https://jade.fyi/blog/development-in-wsl/</a> for some more tuning</li>
</ul>
<h3 id="step-2-install-basic-tools"><a class="header" href="#step-2-install-basic-tools">Step 2: Install basic tools</a></h3>
<p><code>apt</code> is the package manager for Ubuntu, and it's what you'll use to install and update software for your WSL installation</p>
<p>Run <code>sudo apt install netcat curl python3</code> in the terminal to install basic tools</p>
<p>In the future, run <code>sudo apt update</code> and <code>sudo apt upgrade</code> occasionally to keep everything up to date</p>
<h3 id="step-3-install-python-libraries"><a class="header" href="#step-3-install-python-libraries">Step 3: Install python libraries</a></h3>
<p><code>pip</code> is the package manager for Python and you'll use it to install libraries and keep them up to date</p>
<p><code>virtualenv</code> creates small environments that you can safely install your tools into without having to worry about it affecting the rest of your system</p>
<p>Run <code>mkdir ctf</code> to make a folder to put all your ctf related stuff in and <code>cd ctf</code> to move into it</p>
<p>Run <code>python3 -m venv ctf</code> to create a virtual environment (this may take awhile) and run <code>source ctf/bin/activate</code> to activate it. You should now see a little <code>(ctf)</code> on your terminal prompt</p>
<p>Run <code>python -m ensurepip --upgrade</code> to install <code>pip</code></p>
<p>Run <code>python -m pip install pycryptodome pwntools</code> to install the two libraries you'll need (this may take awhile)</p>
<p>Run <code>deactivate</code> after you're done to leave the virtual environment. Remember to run <code>source ctf/bin/activate</code> each time you restart your terminal to enter the venv</p>
<h3 id="step-4-install-docker-and-vscode"><a class="header" href="#step-4-install-docker-and-vscode">Step 4: Install docker and vscode</a></h3>
<p>Visual studio code is a versatile editor with great integration with WSL, I recommend it if you don't have a particular preference for editor <a href="https://code.visualstudio.com/">https://code.visualstudio.com/</a></p>
<p>Instructions for installing Docker with the WSL2 backend can be found on <a href="https://docs.docker.com/desktop/windows/wsl/">https://docs.docker.com/desktop/windows/wsl/</a> </p>
<p>Details for enabling the WSL features</p>
<ul>
<li><a href="https://docs.microsoft.com/en-us/windows/wsl/tutorials/wsl-vscode">https://docs.microsoft.com/en-us/windows/wsl/tutorials/wsl-vscode</a></li>
<li><a href="https://docs.microsoft.com/en-us/windows/wsl/tutorials/wsl-containers">https://docs.microsoft.com/en-us/windows/wsl/tutorials/wsl-containers</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="environment-setup-macos"><a class="header" href="#environment-setup-macos">Environment setup: MacOS</a></h2>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
